'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var $projectMore = '选择项目';
exports.default = Page({
  data: {
    '__code__': {
      readme: ''
    },

    currentPet: {},
    pets: [],
    project_more: $projectMore,
    toastText: '',
    showToast: false,
    shopList: [],
    cpShopList: [],
    showShopListPop: 'hide',
    currentShop: {},
    beauticianList: [],
    currentBeautician: {},
    projectList: [],
    currentProject: {},
    chooseProjects: [], // 已经选择的项目
    appointmentDayList: [],
    currentAppointmentDay: '',
    appointmentTimeList: [],
    currentAppointmentTimes: [] // 预约的时间
  },
  handlerSearch: function handlerSearch(event) {
    var value = event.detail.value;
    var shopList = this.data.shopList;
    var cpShopList = shopList.filter(function (item) {
      return item.shop_name.match(new RegExp(value));
    });

    this.setData({
      cpShopList: cpShopList
    });
  },

  showShopList: function showShopList() {
    this.setData({
      showShopListPop: 'show'
    });
  },

  chooseShop: function chooseShop(event) {
    var index = event.currentTarget.dataset.index;
    var currentShop = this.data.shopList[index];
    this.setData({
      currentShop: currentShop,
      showShopListPop: 'hide'
    });

    this.getBeauticianAndProject(currentShop.shop_id);
  },

  // 选择项目
  chooseProject: function chooseProject(event) {
    var _setData,
        _this = this;

    var index = event.currentTarget.dataset.index;
    var currentProject = this.data.projectList[index];

    // 判断是否已经选择了项目
    var chooseProjects = this.data.chooseProjects;
    var findIndex = chooseProjects.findIndex(function (item) {
      return item === currentProject;
    });

    console.log(findIndex);

    if (findIndex >= 0) {
      currentProject.active = false;
      chooseProjects.splice(findIndex, 1);
    } else {
      currentProject.active = true;
      chooseProjects.push(currentProject);
    }

    // const projectList = this.data.projectList
    // projectList[index] = currentProject

    this.setData((_setData = {
      currentProject: currentProject
    }, _defineProperty(_setData, 'projectList[' + index + ']', currentProject), _defineProperty(_setData, 'chooseProjects', chooseProjects), _setData), function () {
      return console.log(_this.data.chooseProjects);
    });

    // 预约时间
    var timeList = this.data.appointmentTimeList;
    timeList.forEach(function (item) {
      return item.checked = false;
    });
    this.setData({
      currentAppointmentTimes: [],
      appointmentTimeList: timeList
    });
  },

  choosePet: function choosePet(event) {
    var index = event.currentTarget.dataset.index;
    var currentPet = this.data.pets[index];
    if (currentPet.pet_id === this.data.currentPet.pet_id) return;

    this.setData({
      currentPet: currentPet
    });
  },

  chooseBeautician: function chooseBeautician(event) {
    var index = event.currentTarget.dataset.index;
    var currentBeautician = this.data.beauticianList[index];
    if (currentBeautician.beautician_id === this.data.currentBeautician.beautician_id) return;

    this.setData({
      currentBeautician: currentBeautician
    });

    var beauticianId = currentBeautician.beautician_id;
    var day = this.data.currentAppointmentDay.day;
    this.getAppointmentTimes(beauticianId, day);
  },

  chooseDay: function chooseDay(event) {
    var index = event.currentTarget.dataset.index;
    var currentAppointmentDay = this.data.appointmentDayList[index];

    if (currentAppointmentDay.day === this.data.currentAppointmentDay.day) return;

    this.setData({
      currentAppointmentDay: currentAppointmentDay
    });

    var beauticianId = this.data.currentBeautician.beautician_id;
    var day = currentAppointmentDay.day;
    this.getAppointmentTimes(beauticianId, day);
  },

  _toast: function _toast(text) {
    wx.showToast({
      title: text,
      duration: 2000,
      icon: 'none'
    });
  },


  chooseTime: function chooseTime(event) {
    var everyTime = 30;
    var index = event.currentTarget.dataset.index;
    var time = this.data.appointmentTimeList[index];
    if (!time.valid) return false;

    var timeList = this.data.appointmentTimeList;
    timeList.forEach(function (item) {
      return item.checked = false;
    });

    var chooseProjects = this.data.chooseProjects;
    if (!chooseProjects.length) return this._toast('请选择预约项目');

    var projectUseTime = chooseProjects.reduce(function (init, item) {
      return item.use_time / 1 + init;
    }, 0);

    var useTimeNum = Math.ceil(projectUseTime / everyTime);
    var timeListLength = this.data.appointmentTimeList.length;
    if (index + useTimeNum > timeListLength) {
      this.setData({
        currentAppointmentTimes: [],
        appointmentTimeList: timeList
      });

      this._toast('预约时间不足,请重新选择.');

      return;
    }
    var start = 0;
    var useTime = [];
    while (start < useTimeNum) {
      var item = timeList[index + start++];
      if (!item.valid) {
        timeList.forEach(function (item) {
          return item.checked = false;
        });
        useTime = [];
        this.setData({
          currentAppointmentTimes: useTime,
          appointmentTimeList: timeList
        });
        this._toast('预约时间不足');
        break;
      }
      item.checked = true;
      useTime.push(item.time);
    }

    this.setData({
      currentAppointmentTimes: useTime,
      appointmentTimeList: timeList
    });
  },

  getBeauticianAndProject: function getBeauticianAndProject(shopId) {
    var app = getApp();
    var self = this;
    app.get('appointment/getBeauticianAndProject/' + shopId).then(function (data) {
      var content = data.data && data.data.content || {};

      content.days = content.days.map(function (item) {
        var day = item.split('#');
        return {
          date: day[0],
          week: day[1],
          day: day[2]
        };
      });

      content.projects = content.projects || [];
      content.projects.forEach(function (item) {
        return item.active = false;
      });

      // 默认选择的项目
      var currentProject = content.projects[0] || {};
      currentProject.active = true;

      var currentBeautician = content.beauticians[0] || {};
      var currentAppointmentDay = content.days[0] || {};

      self.setData({
        beauticianList: content.beauticians,
        projectList: content.projects,
        project_more: $projectMore + (content.projects.length > 3 ? '(右滑查看更多)' : ''),
        appointmentDayList: content.days,
        currentProject: currentProject,
        chooseProjects: [currentProject],
        currentBeautician: currentBeautician,
        currentAppointmentDay: currentAppointmentDay
      });

      self.getAppointmentTimes(currentBeautician.beautician_id, currentAppointmentDay.day);
    }).catch(function (e) {
      console.log(e);
    });
  },

  getPets: function getPets() {
    var app = getApp();
    var self = this;

    app.get('pet/findMyPets').then(function (data) {
      var currentPet = data.data.content[0];
      if (!currentPet) currentPet = {};

      self.setData({
        pets: data.data.content,
        currentPet: currentPet
      });
    });
  },


  getAppointmentTimes: function getAppointmentTimes(beauticianId, day) {
    var app = getApp();
    var self = this;
    this.setData({
      currentAppointmentTimes: []
    });

    return app.get('appointment/getAppointmentTime/' + beauticianId + '/' + day).then(function (data) {
      var content = data.data && data.data.content || [];
      // for (var i in [0, 0, 0, 0])
      //   content.push({})

      self.setData({
        appointmentTimeList: content
      });
    });
  },

  // 发送预约
  appointment: function appointment(event) {
    var _this2 = this;

    var app = getApp();
    var formId = event.detail.formId;
    var chooseProjects = this.data.chooseProjects;
    if (!chooseProjects.length) return this._toast('请选择预约项目');

    // 预约项目
    var projectIds = chooseProjects.map(function (item) {
      return item.project_id;
    });
    projectIds = projectIds.join(',');

    // 预约
    var data = {
      shop_id: this.data.currentShop.shop_id,
      pet_id: this.data.currentPet.pet_id,
      beautician_id: this.data.currentBeautician.beautician_id,
      project_id: projectIds,
      appointment_day: this.data.currentAppointmentDay.day,
      appointment_time: this.data.currentAppointmentTimes.join(','),
      from: 'xcx',
      formId: formId
    };
    app.post('cart/appointment', data).then(function () {
      _this2._toast('预约成功!');

      _this2.getAppointmentTimes(data.beautician_id, data.appointment_day);

      setTimeout(function (x) {
        wx.navigateTo({
          url: '/pages/order/index'
        });
      }, 1000);

      // 通知
      // app.askNotice()
    }).catch(function (error) {
      _this2._toast(error.detail || '预约失败!');
    });
  },

  addPet: function addPet() {
    wx.navigateTo({
      url: '/pages/pet/index'
    });
  },


  init: function init() {
    var app = getApp();
    var self = this;

    self.getPets();

    wx.getLocation({
      success: function success(data) {
        app.get('shop/getList', { latitude: data.latitude, longitude: data.longitude }).then(function (data) {
          var result = data.data;
          var currentShop = result.content[0] || {};
          self.setData({
            shopList: result.content,
            cpShopList: result.content
          });

          // 判断shop_id是否存在
          if (self.data.currentShop.shop_id) {
            currentShop = self.data.currentShop;
            self.setData({
              currentShop: currentShop
            });
          } else {
            self.setData({
              currentShop: currentShop
            });
          }

          if (currentShop) self.getBeauticianAndProject(currentShop.shop_id);
        }).catch(function (e) {
          return console.log(e);
        });
      },
      fail: function fail() {
        wx.openSetting({
          success: function success(res) {},
          fail: function fail() {}
        });
      }
    });
  },

  onShow: function onShow() {
    if (!this.data.pets.length) this.getPets();

    var data = this.data;
    // 加载
    if (data.currentBeautician.beautician_id && data.currentAppointmentDay.day) {
      this.getAppointmentTimes(data.currentBeautician.beautician_id, data.currentAppointmentDay.day);
    }
  },

  onTabItemTap: function onTabItemTap() {
    this.init();
  }
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4Lnd4cCJdLCJuYW1lcyI6WyIkcHJvamVjdE1vcmUiLCJkYXRhIiwiY3VycmVudFBldCIsInBldHMiLCJwcm9qZWN0X21vcmUiLCJ0b2FzdFRleHQiLCJzaG93VG9hc3QiLCJzaG9wTGlzdCIsImNwU2hvcExpc3QiLCJzaG93U2hvcExpc3RQb3AiLCJjdXJyZW50U2hvcCIsImJlYXV0aWNpYW5MaXN0IiwiY3VycmVudEJlYXV0aWNpYW4iLCJwcm9qZWN0TGlzdCIsImN1cnJlbnRQcm9qZWN0IiwiY2hvb3NlUHJvamVjdHMiLCJhcHBvaW50bWVudERheUxpc3QiLCJjdXJyZW50QXBwb2ludG1lbnREYXkiLCJhcHBvaW50bWVudFRpbWVMaXN0IiwiY3VycmVudEFwcG9pbnRtZW50VGltZXMiLCJoYW5kbGVyU2VhcmNoIiwiZXZlbnQiLCJ2YWx1ZSIsImRldGFpbCIsImZpbHRlciIsIml0ZW0iLCJzaG9wX25hbWUiLCJtYXRjaCIsIlJlZ0V4cCIsInNldERhdGEiLCJzaG93U2hvcExpc3QiLCJjaG9vc2VTaG9wIiwiaW5kZXgiLCJjdXJyZW50VGFyZ2V0IiwiZGF0YXNldCIsImdldEJlYXV0aWNpYW5BbmRQcm9qZWN0Iiwic2hvcF9pZCIsImNob29zZVByb2plY3QiLCJmaW5kSW5kZXgiLCJjb25zb2xlIiwibG9nIiwiYWN0aXZlIiwic3BsaWNlIiwicHVzaCIsInRpbWVMaXN0IiwiZm9yRWFjaCIsImNoZWNrZWQiLCJjaG9vc2VQZXQiLCJwZXRfaWQiLCJjaG9vc2VCZWF1dGljaWFuIiwiYmVhdXRpY2lhbl9pZCIsImJlYXV0aWNpYW5JZCIsImRheSIsImdldEFwcG9pbnRtZW50VGltZXMiLCJjaG9vc2VEYXkiLCJfdG9hc3QiLCJ0ZXh0Iiwid3giLCJ0aXRsZSIsImR1cmF0aW9uIiwiaWNvbiIsImNob29zZVRpbWUiLCJldmVyeVRpbWUiLCJ0aW1lIiwidmFsaWQiLCJsZW5ndGgiLCJwcm9qZWN0VXNlVGltZSIsInJlZHVjZSIsImluaXQiLCJ1c2VfdGltZSIsInVzZVRpbWVOdW0iLCJNYXRoIiwiY2VpbCIsInRpbWVMaXN0TGVuZ3RoIiwic3RhcnQiLCJ1c2VUaW1lIiwic2hvcElkIiwiYXBwIiwiZ2V0QXBwIiwic2VsZiIsImdldCIsInRoZW4iLCJjb250ZW50IiwiZGF5cyIsIm1hcCIsInNwbGl0IiwiZGF0ZSIsIndlZWsiLCJwcm9qZWN0cyIsImJlYXV0aWNpYW5zIiwiY2F0Y2giLCJlIiwiZ2V0UGV0cyIsImFwcG9pbnRtZW50IiwiZm9ybUlkIiwicHJvamVjdElkcyIsInByb2plY3RfaWQiLCJqb2luIiwiYXBwb2ludG1lbnRfZGF5IiwiYXBwb2ludG1lbnRfdGltZSIsImZyb20iLCJwb3N0Iiwic2V0VGltZW91dCIsIm5hdmlnYXRlVG8iLCJ1cmwiLCJlcnJvciIsImFkZFBldCIsImdldExvY2F0aW9uIiwic3VjY2VzcyIsImxhdGl0dWRlIiwibG9uZ2l0dWRlIiwicmVzdWx0IiwiZmFpbCIsIm9wZW5TZXR0aW5nIiwicmVzIiwib25TaG93Iiwib25UYWJJdGVtVGFwIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBLElBQU1BLGVBQWUsTUFBckI7O0FBZUlDLFFBQU07QUFBQTtBQUFBO0FBQUE7O0FBQ0pDLGdCQUFXLEVBRFA7QUFFSkMsVUFBTSxFQUZGO0FBR0pDLGtCQUFjSixZQUhWO0FBSUpLLGVBQVcsRUFKUDtBQUtKQyxlQUFXLEtBTFA7QUFNSkMsY0FBVSxFQU5OO0FBT0pDLGdCQUFZLEVBUFI7QUFRSkMscUJBQWlCLE1BUmI7QUFTSkMsaUJBQWEsRUFUVDtBQVVKQyxvQkFBZ0IsRUFWWjtBQVdKQyx1QkFBbUIsRUFYZjtBQVlKQyxpQkFBYSxFQVpUO0FBYUpDLG9CQUFnQixFQWJaO0FBY0pDLG9CQUFnQixFQWRaLEVBY2dCO0FBQ3BCQyx3QkFBb0IsRUFmaEI7QUFnQkpDLDJCQUF1QixFQWhCbkI7QUFpQkpDLHlCQUFxQixFQWpCakI7QUFrQkpDLDZCQUF5QixFQWxCckIsQ0FrQnlCO0FBbEJ6QixHO0FBb0JOQyxpQkFBZSx1QkFB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QUF2RSxFQUE0RTtBQUMxRSxXQUFLQyxtQkFBTCxDQUF5QnBELEtBQUtXLGlCQUFMLENBQXVCc0MsYUFBaEQsRUFBK0RqRCxLQUFLZ0IscUJBQUwsQ0FBMkJtQyxHQUExRjtBQUNEO0FBRUYsRzs7QUFFRGdFLGdCQUFjLHdCQUFXO0FBQ3ZCLFNBQUtoRCxJQUFMO0FBQ0QiLCJmaWxlIjoiaW5kZXgud3hwIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgJHByb2plY3RNb3JlID0gJ+mAieaLqemhueebridcbiAgZXhwb3J0IGRlZmF1bHQge1xuICAgIGNvbmZpZzoge1xuICAgICAgbmF2aWdhdGlvbkJhclRpdGxlVGV4dDogJ+mihOe6picsXG4gICAgICBuYXZpZ2F0aW9uQmFyQmFja2dyb3VuZENvbG9yOiAnI2ZmZmZmZicsXG4gICAgICBuYXZpZ2F0aW9uQmFyVGV4dFN0eWxlOiAnYmxhY2snLFxuICAgICAgdXNpbmdDb21wb25lbnRzOiB7XG4gICAgICAgICd3eGMtZmxleCc6ICdAbWludWkvd3hjLWZsZXgnLFxuICAgICAgICAnd3hjLWljb24nOiAnQG1pbnVpL3d4Yy1pY29uJyxcbiAgICAgICAgJ3d4Yy1hdmF0YXInOiAnQG1pbnVpL3d4Yy1hdmF0YXInLFxuICAgICAgICAnd3hjLW1hc2snOiAnQG1pbnVpL3d4Yy1tYXNrJyxcbiAgICAgICAgJ3d4Yy1wb3B1cCc6ICdAbWludWkvd3hjLXBvcHVwJyxcbiAgICAgICAgJ3d4Yy1lbGlwJzogJ0BtaW51aS93eGMtZWxpcCcsXG4gICAgICB9XG4gICAgfSxcbiAgICBkYXRhOiB7XG4gICAgICBjdXJyZW50UGV0Ont9LFxuICAgICAgcGV0czogW10sXG4gICAgICBwcm9qZWN0X21vcmU6ICRwcm9qZWN0TW9yZSxcbiAgICAgIHRvYXN0VGV4dDogJycsXG4gICAgICBzaG93VG9hc3Q6IGZhbHNlLFxuICAgICAgc2hvcExpc3Q6IFtdLFxuICAgICAgY3BTaG9wTGlzdDogW10sXG4gICAgICBzaG93U2hvcExpc3RQb3A6ICdoaWRlJyxcbiAgICAgIGN1cnJlbnRTaG9wOiB7fSxcbiAgICAgIGJlYXV0aWNpYW5MaXN0OiBbXSxcbiAgICAgIGN1cnJlbnRCZWF1dGljaWFuOiB7fSxcbiAgICAgIHByb2plY3RMaXN0OiBbXSxcbiAgICAgIGN1cnJlbnRQcm9qZWN0OiB7fSxcbiAgICAgIGNob29zZVByb2plY3RzOiBbXSwgLy8g5bey57uP6YCJ5oup55qE6aG555uuXG4gICAgICBhcHBvaW50bWVudERheUxpc3Q6IFtdLFxuICAgICAgY3VycmVudEFwcG9pbnRtZW50RGF5OiAnJyxcbiAgICAgIGFwcG9pbnRtZW50VGltZUxpc3Q6IFtdLFxuICAgICAgY3VycmVudEFwcG9pbnRtZW50VGltZXM6IFtdLCAvLyDpooTnuqbnmoTml7bpl7RcbiAgICB9LFxuICAgIGhhbmRsZXJTZWFyY2g6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgbGV0IHZhbHVlID0gZXZlbnQuZGV0YWlsLnZhbHVlXG4gICAgICBsZXQgc2hvcExpc3QgPSB0aGlzLmRhdGEuc2hvcExpc3RcbiAgICAgIGxldCBjcFNob3BMaXN0ID0gc2hvcExpc3QuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIHJldHVybiBpdGVtLnNob3BfbmFtZS5tYXRjaChuZXcgUmVnRXhwKHZhbHVlKSlcbiAgICAgIH0pXG5cbiAgICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICAgIGNwU2hvcExpc3Q6IGNwU2hvcExpc3RcbiAgICAgIH0pXG4gICAgfSxcblxuICAgIHNob3dTaG9wTGlzdDogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5zZXREYXRhKHtcbiAgICAgICAgc2hvd1Nob3BMaXN0UG9wOiAnc2hvdydcbiAgICAgIH0pXG4gICAgfSxcblxuICAgIGNob29zZVNob3A6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgbGV0IGluZGV4ID0gZXZlbnQuY3VycmVudFRhcmdldC5kYXRhc2V0LmluZGV4XG4gICAgICBsZXQgY3VycmVudFNob3AgPSB0aGlzLmRhdGEuc2hvcExpc3RbaW5kZXhdXG4gICAgICB0aGlzLnNldERhdGEoe1xuICAgICAgICBjdXJyZW50U2hvcDogY3VycmVudFNob3AsXG4gICAgICAgIHNob3dTaG9wTGlzdFBvcDogJ2hpZGUnLFxuICAgICAgfSlcblxuICAgICAgdGhpcy5nZXRCZWF1dGljaWFuQW5kUHJvamVjdChjdXJyZW50U2hvcC5zaG9wX2lkKVxuICAgIH0sXG5cbiAgICAvLyDpgInmi6npobnnm65cbiAgICBjaG9vc2VQcm9qZWN0OiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIGxldCBpbmRleCA9IGV2ZW50LmN1cnJlbnRUYXJnZXQuZGF0YXNldC5pbmRleFxuICAgICAgbGV0IGN1cnJlbnRQcm9qZWN0ID0gdGhpcy5kYXRhLnByb2plY3RMaXN0W2luZGV4XVxuXG4gICAgICAvLyDliKTmlq3mmK/lkKblt7Lnu4/pgInmi6nkuobpobnnm65cbiAgICAgIGNvbnN0IGNob29zZVByb2plY3RzID0gdGhpcy5kYXRhLmNob29zZVByb2plY3RzXG4gICAgICBjb25zdCBmaW5kSW5kZXggPSBjaG9vc2VQcm9qZWN0cy5maW5kSW5kZXgoaXRlbSA9PiBpdGVtID09PSBjdXJyZW50UHJvamVjdClcbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coZmluZEluZGV4KVxuXG4gICAgICBpZiAoZmluZEluZGV4ID49IDApIHtcbiAgICAgICAgY3VycmVudFByb2plY3QuYWN0aXZlID0gZmFsc2VcbiAgICAgICAgY2hvb3NlUHJvamVjdHMuc3BsaWNlKGZpbmRJbmRleCwgMSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGN1cnJlbnRQcm9qZWN0LmFjdGl2ZSA9IHRydWVcbiAgICAgICAgY2hvb3NlUHJvamVjdHMucHVzaChjdXJyZW50UHJvamVjdClcbiAgICAgIH1cblxuICAgICAgLy8gY29uc3QgcHJvamVjdExpc3QgPSB0aGlzLmRhdGEucHJvamVjdExpc3RcbiAgICAgIC8vIHByb2plY3RMaXN0W2luZGV4XSA9IGN1cnJlbnRQcm9qZWN0XG5cbiAgICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICAgIGN1cnJlbnRQcm9qZWN0OiBjdXJyZW50UHJvamVjdCxcbiAgICAgICAgW2Bwcm9qZWN0TGlzdFske2luZGV4fV1gXTogY3VycmVudFByb2plY3QsXG4gICAgICAgIGNob29zZVByb2plY3RzXG4gICAgICB9LCAoKSA9PiBjb25zb2xlLmxvZyh0aGlzLmRhdGEuY2hvb3NlUHJvamVjdHMpKVxuXG5cbiAgICAgIC8vIOmihOe6puaXtumXtFxuICAgICAgbGV0IHRpbWVMaXN0ID0gdGhpcy5kYXRhLmFwcG9pbnRtZW50VGltZUxpc3RcbiAgICAgIHRpbWVMaXN0LmZvckVhY2goaXRlbSA9PiBpdGVtLmNoZWNrZWQgPSBmYWxzZSlcbiAgICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICAgIGN1cnJlbnRBcHBvaW50bWVudFRpbWVzOiBbXSxcbiAgICAgICAgYXBwb2ludG1lbnRUaW1lTGlzdDogdGltZUxpc3RcbiAgICAgIH0pXG4gICAgfSxcblxuICAgIGNob29zZVBldDogZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICBsZXQgaW5kZXggPSBldmVudC5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuaW5kZXhcbiAgICAgIGxldCBjdXJyZW50UGV0ID0gdGhpcy5kYXRhLnBldHNbaW5kZXhdXG4gICAgICBpZiAoY3VycmVudFBldC5wZXRfaWQgPT09IHRoaXMuZGF0YS5jdXJyZW50UGV0LnBldF9pZClcbiAgICAgICAgcmV0dXJuXG5cbiAgICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICAgIGN1cnJlbnRQZXQsXG4gICAgICB9KVxuICAgIH0sXG5cbiAgICBjaG9vc2VCZWF1dGljaWFuOiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIGxldCBpbmRleCA9IGV2ZW50LmN1cnJlbnRUYXJnZXQuZGF0YXNldC5pbmRleFxuICAgICAgbGV0IGN1cnJlbnRCZWF1dGljaWFuID0gdGhpcy5kYXRhLmJlYXV0aWNpYW5MaXN0W2luZGV4XVxuICAgICAgaWYgKGN1cnJlbnRCZWF1dGljaWFuLmJlYXV0aWNpYW5faWQgPT09IHRoaXMuZGF0YS5jdXJyZW50QmVhdXRpY2lhbi5iZWF1dGljaWFuX2lkKVxuICAgICAgICByZXR1cm5cblxuICAgICAgdGhpcy5zZXREYXRhKHtcbiAgICAgICAgY3VycmVudEJlYXV0aWNpYW46IGN1cnJlbnRCZWF1dGljaWFuLFxuICAgICAgfSlcblxuICAgICAgbGV0IGJlYXV0aWNpYW5JZCA9IGN1cnJlbnRCZWF1dGljaWFuLmJlYXV0aWNpYW5faWRcbiAgICAgIGxldCBkYXkgPSB0aGlzLmRhdGEuY3VycmVudEFwcG9pbnRtZW50RGF5LmRheVxuICAgICAgdGhpcy5nZXRBcHBvaW50bWVudFRpbWVzKGJlYXV0aWNpYW5JZCwgZGF5KVxuICAgIH0sXG5cblxuICAgIGNob29zZURheTogZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICBsZXQgaW5kZXggPSBldmVudC5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuaW5kZXhcbiAgICAgIGxldCBjdXJyZW50QXBwb2ludG1lbnREYXkgPSB0aGlzLmRhdGEuYXBwb2ludG1lbnREYXlMaXN0W2luZGV4XVxuXG4gICAgICBpZiAoY3VycmVudEFwcG9pbnRtZW50RGF5LmRheSA9PT0gdGhpcy5kYXRhLmN1cnJlbnRBcHBvaW50bWVudERheS5kYXkpXG4gICAgICAgIHJldHVyblxuXG4gICAgICB0aGlzLnNldERhdGEoe1xuICAgICAgICBjdXJyZW50QXBwb2ludG1lbnREYXk6IGN1cnJlbnRBcHBvaW50bWVudERheSxcbiAgICAgIH0pXG5cbiAgICAgIGxldCBiZWF1dGljaWFuSWQgPSB0aGlzLmRhdGEuY3VycmVudEJlYXV0aWNpYW4uYmVhdXRpY2lhbl9pZFxuICAgICAgbGV0IGRheSA9IGN1cnJlbnRBcHBvaW50bWVudERheS5kYXlcbiAgICAgIHRoaXMuZ2V0QXBwb2ludG1lbnRUaW1lcyhiZWF1dGljaWFuSWQsIGRheSlcbiAgICB9LFxuXG4gICAgX3RvYXN0KHRleHQpIHtcbiAgICAgIHd4LnNob3dUb2FzdCh7XG4gICAgICAgIHRpdGxlOiB0ZXh0LFxuICAgICAgICBkdXJhdGlvbjogMjAwMCxcbiAgICAgICAgaWNvbjogJ25vbmUnXG4gICAgICB9KVxuICAgIH0sXG5cbiAgICBjaG9vc2VUaW1lOiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIGxldCBldmVyeVRpbWUgPSAzMFxuICAgICAgbGV0IGluZGV4ID0gZXZlbnQuY3VycmVudFRhcmdldC5kYXRhc2V0LmluZGV4XG4gICAgICBsZXQgdGltZSA9IHRoaXMuZGF0YS5hcHBvaW50bWVudFRpbWVMaXN0W2luZGV4XVxuICAgICAgaWYgKCF0aW1lLnZhbGlkKVxuICAgICAgICByZXR1cm4gZmFsc2VcblxuICAgICAgbGV0IHRpbWVMaXN0ID0gdGhpcy5kYXRhLmFwcG9pbnRtZW50VGltZUxpc3RcbiAgICAgIHRpbWVMaXN0LmZvckVhY2goaXRlbSA9PiBpdGVtLmNoZWNrZWQgPSBmYWxzZSlcblxuICAgICAgY29uc3QgY2hvb3NlUHJvamVjdHMgPSB0aGlzLmRhdGEuY2hvb3NlUHJvamVjdHNcbiAgICAgIGlmICghY2hvb3NlUHJvamVjdHMubGVuZ3RoKVxuICAgICAgICByZXR1cm4gdGhpcy5fdG9hc3QoJ+ivt+mAieaLqemihOe6pumhueebricpXG5cbiAgICAgIGNvbnN0IHByb2plY3RVc2VUaW1lID0gY2hvb3NlUHJvamVjdHMucmVkdWNlKChpbml0LCBpdGVtKSA9PiBpdGVtLnVzZV90aW1lIC8gMSArIGluaXQsIDApXG5cbiAgICAgIGxldCB1c2VUaW1lTnVtID0gTWF0aC5jZWlsKHByb2plY3RVc2VUaW1lIC8gZXZlcnlUaW1lKVxuICAgICAgbGV0IHRpbWVMaXN0TGVuZ3RoID0gdGhpcy5kYXRhLmFwcG9pbnRtZW50VGltZUxpc3QubGVuZ3RoXG4gICAgICBpZiAoaW5kZXggKyB1c2VUaW1lTnVtID4gdGltZUxpc3RMZW5ndGgpIHtcbiAgICAgICAgdGhpcy5zZXREYXRhKHtcbiAgICAgICAgICBjdXJyZW50QXBwb2ludG1lbnRUaW1lczogW10sXG4gICAgICAgICAgYXBwb2ludG1lbnRUaW1lTGlzdDogdGltZUxpc3QsXG4gICAgICAgIH0pXG5cbiAgICAgICAgdGhpcy5fdG9hc3QoJ+mihOe6puaXtumXtOS4jei2syzor7fph43mlrDpgInmi6kuJylcblxuICAgICAgICByZXR1cm5cbiAgICAgIH1cbiAgICAgIGxldCBzdGFydCA9IDBcbiAgICAgIGxldCB1c2VUaW1lID0gW11cbiAgICAgIHdoaWxlIChzdGFydCA8IHVzZVRpbWVOdW0pIHtcbiAgICAgICAgbGV0IGl0ZW0gPSB0aW1lTGlzdFtpbmRleCArIHN0YXJ0KytdXG4gICAgICAgIGlmKCFpdGVtLnZhbGlkKSB7XG4gICAgICAgICAgdGltZUxpc3QuZm9yRWFjaChpdGVtID0+IGl0ZW0uY2hlY2tlZCA9IGZhbHNlKVxuICAgICAgICAgIHVzZVRpbWUgPSBbXVxuICAgICAgICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICAgICAgICBjdXJyZW50QXBwb2ludG1lbnRUaW1lczogdXNlVGltZSxcbiAgICAgICAgICAgIGFwcG9pbnRtZW50VGltZUxpc3Q6IHRpbWVMaXN0LFxuICAgICAgICAgIH0pXG4gICAgICAgICAgdGhpcy5fdG9hc3QoJ+mihOe6puaXtumXtOS4jei2sycpXG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgaXRlbS5jaGVja2VkID0gdHJ1ZVxuICAgICAgICB1c2VUaW1lLnB1c2goaXRlbS50aW1lKVxuICAgICAgfVxuXG4gICAgICB0aGlzLnNldERhdGEoe1xuICAgICAgICBjdXJyZW50QXBwb2ludG1lbnRUaW1lczogdXNlVGltZSxcbiAgICAgICAgYXBwb2ludG1lbnRUaW1lTGlzdDogdGltZUxpc3RcbiAgICAgIH0pXG5cbiAgICB9LFxuXG4gICAgZ2V0QmVhdXRpY2lhbkFuZFByb2plY3Q6IGZ1bmN0aW9uIChzaG9wSWQpIHtcbiAgICAgIGxldCBhcHAgPSBnZXRBcHAoKVxuICAgICAgbGV0IHNlbGYgPSB0aGlzXG4gICAgICBhcHAuZ2V0KGBhcHBvaW50bWVudC9nZXRCZWF1dGljaWFuQW5kUHJvamVjdC8ke3Nob3BJZH1gKS50aGVuKGRhdGEgPT4ge1xuICAgICAgICBsZXQgY29udGVudCA9IChkYXRhLmRhdGEgJiYgZGF0YS5kYXRhLmNvbnRlbnQpIHx8IHt9XG5cbiAgICAgICAgY29udGVudC5kYXlzID0gY29udGVudC5kYXlzLm1hcChpdGVtID0+IHtcbiAgICAgICAgICBsZXQgZGF5ID0gaXRlbS5zcGxpdCgnIycpXG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGRhdGU6IGRheVswXSxcbiAgICAgICAgICAgIHdlZWs6IGRheVsxXSxcbiAgICAgICAgICAgIGRheTogZGF5WzJdXG4gICAgICAgICAgfVxuICAgICAgICB9KVxuXG4gICAgICAgIGNvbnRlbnQucHJvamVjdHMgPSBjb250ZW50LnByb2plY3RzIHx8IFtdXG4gICAgICAgIGNvbnRlbnQucHJvamVjdHMuZm9yRWFjaChpdGVtID0+IGl0ZW0uYWN0aXZlID0gZmFsc2UpXG5cbiAgICAgICAgLy8g6buY6K6k6YCJ5oup55qE6aG555uuXG4gICAgICAgIGxldCBjdXJyZW50UHJvamVjdCA9IGNvbnRlbnQucHJvamVjdHNbMF0gfHwge31cbiAgICAgICAgY3VycmVudFByb2plY3QuYWN0aXZlID0gdHJ1ZVxuXG4gICAgICAgIGxldCBjdXJyZW50QmVhdXRpY2lhbiA9IGNvbnRlbnQuYmVhdXRpY2lhbnNbMF0gfHwge31cbiAgICAgICAgbGV0IGN1cnJlbnRBcHBvaW50bWVudERheSA9IGNvbnRlbnQuZGF5c1swXSB8fCB7fVxuXG4gICAgICAgIHNlbGYuc2V0RGF0YSh7XG4gICAgICAgICAgYmVhdXRpY2lhbkxpc3Q6IGNvbnRlbnQuYmVhdXRpY2lhbnMsXG4gICAgICAgICAgcHJvamVjdExpc3Q6IGNvbnRlbnQucHJvamVjdHMsXG4gICAgICAgICAgcHJvamVjdF9tb3JlOiAkcHJvamVjdE1vcmUgKyAoY29udGVudC5wcm9qZWN0cy5sZW5ndGggPiAzID8gICco5Y+z5ruR5p+l55yL5pu05aSaKScgOiAnJyksXG4gICAgICAgICAgYXBwb2ludG1lbnREYXlMaXN0OiBjb250ZW50LmRheXMsXG4gICAgICAgICAgY3VycmVudFByb2plY3QsXG4gICAgICAgICAgY2hvb3NlUHJvamVjdHM6IFtjdXJyZW50UHJvamVjdF0sXG4gICAgICAgICAgY3VycmVudEJlYXV0aWNpYW4sXG4gICAgICAgICAgY3VycmVudEFwcG9pbnRtZW50RGF5LFxuICAgICAgICB9KVxuXG4gICAgICAgIHNlbGYuZ2V0QXBwb2ludG1lbnRUaW1lcyhjdXJyZW50QmVhdXRpY2lhbi5iZWF1dGljaWFuX2lkLCBjdXJyZW50QXBwb2ludG1lbnREYXkuZGF5KVxuICAgICAgfSkuY2F0Y2goZSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGUpXG4gICAgICB9KVxuXG4gICAgfSxcblxuICAgIGdldFBldHMoKSB7XG4gICAgICBsZXQgYXBwID0gZ2V0QXBwKClcbiAgICAgIGxldCBzZWxmID0gdGhpc1xuXG4gICAgICBhcHAuZ2V0KCdwZXQvZmluZE15UGV0cycpLnRoZW4oZGF0YSA9PiB7XG4gICAgICAgIGxldCBjdXJyZW50UGV0ID0gZGF0YS5kYXRhLmNvbnRlbnRbMF1cbiAgICAgICAgaWYgKCFjdXJyZW50UGV0KVxuICAgICAgICAgIGN1cnJlbnRQZXQgPSB7fVxuXG4gICAgICAgIHNlbGYuc2V0RGF0YSh7XG4gICAgICAgICAgcGV0czogZGF0YS5kYXRhLmNvbnRlbnQsXG4gICAgICAgICAgY3VycmVudFBldCxcbiAgICAgICAgfSlcbiAgICAgIH0pXG5cbiAgICB9LFxuXG4gICAgZ2V0QXBwb2ludG1lbnRUaW1lczogZnVuY3Rpb24gKGJlYXV0aWNpYW5JZCwgZGF5KSB7XG4gICAgICBsZXQgYXBwID0gZ2V0QXBwKClcbiAgICAgIGxldCBzZWxmID0gdGhpc1xuICAgICAgdGhpcy5zZXREYXRhKHtcbiAgICAgICAgY3VycmVudEFwcG9pbnRtZW50VGltZXM6IFtdXG4gICAgICB9KVxuXG4gICAgICByZXR1cm4gYXBwLmdldCgnYXBwb2ludG1lbnQvZ2V0QXBwb2ludG1lbnRUaW1lLycgKyBiZWF1dGljaWFuSWQgKyAnLycgKyBkYXkpXG4gICAgICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgICAgbGV0IGNvbnRlbnQgPSAoZGF0YS5kYXRhICYmIGRhdGEuZGF0YS5jb250ZW50KSB8fCBbXVxuICAgICAgICAgIC8vIGZvciAodmFyIGkgaW4gWzAsIDAsIDAsIDBdKVxuICAgICAgICAgIC8vICAgY29udGVudC5wdXNoKHt9KVxuXG4gICAgICAgICAgc2VsZi5zZXREYXRhKHtcbiAgICAgICAgICAgIGFwcG9pbnRtZW50VGltZUxpc3Q6IGNvbnRlbnRcbiAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH0sXG5cbiAgICAvLyDlj5HpgIHpooTnuqZcbiAgICBhcHBvaW50bWVudDogZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICBsZXQgYXBwID0gZ2V0QXBwKClcbiAgICAgIGxldCBmb3JtSWQgPSBldmVudC5kZXRhaWwuZm9ybUlkXG4gICAgICBjb25zdCBjaG9vc2VQcm9qZWN0cyA9IHRoaXMuZGF0YS5jaG9vc2VQcm9qZWN0c1xuICAgICAgaWYgKCFjaG9vc2VQcm9qZWN0cy5sZW5ndGgpXG4gICAgICAgIHJldHVybiB0aGlzLl90b2FzdCgn6K+36YCJ5oup6aKE57qm6aG555uuJylcbiAgICAgIFxuICAgICAgLy8g6aKE57qm6aG555uuXG4gICAgICBsZXQgcHJvamVjdElkcyA9IGNob29zZVByb2plY3RzLm1hcChpdGVtID0+IGl0ZW0ucHJvamVjdF9pZClcbiAgICAgIHByb2plY3RJZHMgPSBwcm9qZWN0SWRzLmpvaW4oJywnKVxuXG4gICAgICAvLyDpooTnuqZcbiAgICAgIGxldCBkYXRhID0ge1xuICAgICAgICBzaG9wX2lkOiB0aGlzLmRhdGEuY3VycmVudFNob3Auc2hvcF9pZCxcbiAgICAgICAgcGV0X2lkOiB0aGlzLmRhdGEuY3VycmVudFBldC5wZXRfaWQsXG4gICAgICAgIGJlYXV0aWNpYW5faWQ6IHRoaXMuZGF0YS5jdXJyZW50QmVhdXRpY2lhbi5iZWF1dGljaWFuX2lkLFxuICAgICAgICBwcm9qZWN0X2lkOiBwcm9qZWN0SWRzLFxuICAgICAgICBhcHBvaW50bWVudF9kYXk6IHRoaXMuZGF0YS5jdXJyZW50QXBwb2ludG1lbnREYXkuZGF5LFxuICAgICAgICBhcHBvaW50bWVudF90aW1lOiB0aGlzLmRhdGEuY3VycmVudEFwcG9pbnRtZW50VGltZXMuam9pbignLCcpLFxuICAgICAgICBmcm9tOiAneGN4JyxcbiAgICAgICAgZm9ybUlkOiBmb3JtSWQsXG4gICAgICB9XG4gICAgICBhcHAucG9zdCgnY2FydC9hcHBvaW50bWVudCcsIGRhdGEpXG4gICAgICAgIC50aGVuKCgpID0+ICAge1xuICAgICAgICAgIHRoaXMuX3RvYXN0KCfpooTnuqbmiJDlip8hJylcblxuICAgICAgICAgIHRoaXMuZ2V0QXBwb2ludG1lbnRUaW1lcyhkYXRhLmJlYXV0aWNpYW5faWQsIGRhdGEuYXBwb2ludG1lbnRfZGF5KVxuICAgICAgICAgIFxuICAgICAgICAgIHNldFRpbWVvdXQoeCA9PiAge1xuICAgICAgICAgICAgd3gubmF2aWdhdGVUbyh7XG4gICAgICAgICAgICAgICAgdXJsOiAnL3BhZ2VzL29yZGVyL2luZGV4J1xuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXG4gICAgICAgICAgICB9LCAxMDAwKVxuXG4gICAgICAgICAgLy8g6YCa55+lXG4gICAgICAgICAgLy8gYXBwLmFza05vdGljZSgpXG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgICAgdGhpcy5fdG9hc3QoZXJyb3IuZGV0YWlsIHx8ICfpooTnuqblpLHotKUhJylcbiAgICAgICAgfSlcbiAgICB9LFxuXG4gICAgYWRkUGV0KCkge1xuICAgICAgd3gubmF2aWdhdGVUbyh7XG4gICAgICAgIHVybDogJy9wYWdlcy9wZXQvaW5kZXgnXG4gICAgICB9KVxuICAgIH0sXG5cbiAgICBpbml0OiBmdW5jdGlvbigpIHtcbiAgICAgIGxldCBhcHAgPSBnZXRBcHAoKVxuICAgICAgbGV0IHNlbGYgPSB0aGlzXG5cbiAgICAgIHNlbGYuZ2V0UGV0cygpXG5cbiAgICAgIHd4LmdldExvY2F0aW9uKHtcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICBhcHAuZ2V0KCdzaG9wL2dldExpc3QnLCB7bGF0aXR1ZGU6IGRhdGEubGF0aXR1ZGUsIGxvbmdpdHVkZTogZGF0YS5sb25naXR1ZGV9KS50aGVuKGRhdGEgPT4ge1xuICAgICAgICAgICAgbGV0IHJlc3VsdCA9IGRhdGEuZGF0YVxuICAgICAgICAgICAgbGV0IGN1cnJlbnRTaG9wID0gcmVzdWx0LmNvbnRlbnRbMF0gfHwge31cbiAgICAgICAgICAgIHNlbGYuc2V0RGF0YSh7XG4gICAgICAgICAgICAgIHNob3BMaXN0OiByZXN1bHQuY29udGVudCxcbiAgICAgICAgICAgICAgY3BTaG9wTGlzdDogcmVzdWx0LmNvbnRlbnQsXG4gICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAvLyDliKTmlq1zaG9wX2lk5piv5ZCm5a2Y5ZyoXG4gICAgICAgICAgICBpZihzZWxmLmRhdGEuY3VycmVudFNob3Auc2hvcF9pZCkge1xuICAgICAgICAgICAgICBjdXJyZW50U2hvcCA9IHNlbGYuZGF0YS5jdXJyZW50U2hvcFxuICAgICAgICAgICAgICBzZWxmLnNldERhdGEoe1xuICAgICAgICAgICAgICAgIGN1cnJlbnRTaG9wXG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBzZWxmLnNldERhdGEoe1xuICAgICAgICAgICAgICAgIGN1cnJlbnRTaG9wXG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChjdXJyZW50U2hvcClcbiAgICAgICAgICAgICAgc2VsZi5nZXRCZWF1dGljaWFuQW5kUHJvamVjdChjdXJyZW50U2hvcC5zaG9wX2lkKVxuICAgICAgICAgIH0pLmNhdGNoKGUgPT4gY29uc29sZS5sb2coZSkpXG4gICAgICAgIH0sXG4gICAgICAgIGZhaWw6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB3eC5vcGVuU2V0dGluZyh7XG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZmFpbDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfSxcblxuICBvblNob3c6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuZGF0YS5wZXRzLmxlbmd0aClcbiAgICAgIHRoaXMuZ2V0UGV0cygpXG5cbiAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhXG4gICAgLy8g5Yqg6L29XG4gICAgaWYgKGRhdGEuY3VycmVudEJlYXV0aWNpYW4uYmVhdXRpY2lhbl9pZCAmJiBkYXRhLmN1cnJlbnRBcHBvaW50bWVudERheS5kYXkpIHtcbiAgICAgIHRoaXMuZ2V0QXBwb2ludG1lbnRUaW1lcyhkYXRhLmN1cnJlbnRCZWF1dGljaWFuLmJlYXV0aWNpYW5faWQsIGRhdGEuY3VycmVudEFwcG9pbnRtZW50RGF5LmRheSlcbiAgICB9XG4gICAgXG4gIH0sXG5cbiAgb25UYWJJdGVtVGFwOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXQoKVxuICB9XG4gIH0iXX0=