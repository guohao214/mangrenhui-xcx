'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = Page({
  data: {
    '__code__': {
      readme: ''
    },

    toastText: '',
    showToast: false,
    shopList: [],
    cpShopList: [],
    showShopListPop: 'hide',
    currentShop: {},
    beauticianList: [],
    currentBeautician: {},
    projectList: [],
    currentProject: {},
    appointmentDayList: [],
    currentAppointmentDay: '',
    appointmentTimeList: [],
    currentAppointmentTimes: [] // 预约的时间
  },
  handlerSearch: function handlerSearch(event) {
    var value = event.detail.value;
    var shopList = this.data.shopList;
    var cpShopList = shopList.filter(function (item) {
      return item.shop_name.match(new RegExp(value));
    });

    this.setData({
      cpShopList: cpShopList
    });
  },
  showShopList: function showShopList() {
    this.setData({
      showShopListPop: 'show'
    });
  },
  chooseShop: function chooseShop(event) {
    var index = event.currentTarget.dataset.index;
    var currentShop = this.data.shopList[index];
    this.setData({
      currentShop: currentShop,
      showShopListPop: 'hide'
    });

    this.getBeauticianAndProject(currentShop.shop_id);
  },
  chooseProject: function chooseProject(event) {
    var index = event.currentTarget.dataset.index;
    var currentProject = this.data.projectList[index];
    this.setData({
      currentProject: currentProject
    });

    var timeList = this.data.appointmentTimeList;
    timeList.forEach(function (item) {
      return item.checked = false;
    });
    this.setData({
      currentAppointmentTimes: [],
      appointmentTimeList: timeList
    });
  },
  chooseBeautician: function chooseBeautician(event) {
    var index = event.currentTarget.dataset.index;
    var currentBeautician = this.data.beauticianList[index];
    this.setData({
      currentBeautician: currentBeautician
    });

    var beauticianId = currentBeautician.beautician_id;
    var day = this.data.currentAppointmentDay.day;
    this.getAppointmentTimes(beauticianId, day);
  },
  chooseDay: function chooseDay(event) {
    var index = event.currentTarget.dataset.index;
    var currentAppointmentDay = this.data.appointmentDayList[index];
    this.setData({
      currentAppointmentDay: currentAppointmentDay
    });

    var beauticianId = this.data.currentBeautician.beautician_id;
    var day = currentAppointmentDay.day;
    this.getAppointmentTimes(beauticianId, day);
  },
  _toast: function _toast(text) {
    wx.showToast({
      title: text,
      duration: 2000,
      icon: 'none'
    });
  },

  chooseTime: function chooseTime(event) {
    var everyTime = 30;
    var index = event.currentTarget.dataset.index;
    var time = this.data.appointmentTimeList[index];
    if (!time.valid) return false;

    var timeList = this.data.appointmentTimeList;
    timeList.forEach(function (item) {
      return item.checked = false;
    });

    var projectUseTime = this.data.currentProject.use_time;
    var useTimeNum = Math.ceil(projectUseTime / everyTime);
    var timeListLength = this.data.appointmentTimeList.length;
    if (index + useTimeNum > timeListLength) {
      this.setData({
        currentAppointmentTimes: [],
        appointmentTimeList: timeList
      });

      this._toast('预约时间不足');

      return;
    }
    var start = 0;
    var useTime = [];
    while (start < useTimeNum) {
      var item = timeList[index + start++];
      if (!item.valid) {
        timeList.forEach(function (item) {
          return item.checked = false;
        });
        useTime = [];
        this.setData({
          currentAppointmentTimes: useTime,
          appointmentTimeList: timeList
        });
        this._toast('预约时间不足');
        break;
      }
      item.checked = true;
      useTime.push(item.time);
    }

    this.setData({
      currentAppointmentTimes: useTime,
      appointmentTimeList: timeList
    });
  },
  getBeauticianAndProject: function getBeauticianAndProject(shopId) {
    var app = getApp();
    var self = this;
    app.get('appointment/getBeauticianAndProject/' + shopId).then(function (data) {
      var content = data.data && data.data.content || {};

      content.days = content.days.map(function (item) {
        var day = item.split('#');
        return {
          date: day[0],
          week: day[1],
          day: day[2]
        };
      });

      var currentProject = content.projects[0] || {};
      var currentBeautician = content.beauticians[0] || {};
      var currentAppointmentDay = content.days[0] || {};

      self.setData({
        beauticianList: content.beauticians,
        projectList: content.projects,
        appointmentDayList: content.days,
        currentProject: currentProject,
        currentBeautician: currentBeautician,
        currentAppointmentDay: currentAppointmentDay
      });

      self.getAppointmentTimes(currentBeautician.beautician_id, currentAppointmentDay.day);
    });
  },
  getAppointmentTimes: function getAppointmentTimes(beauticianId, day) {
    var app = getApp();
    var self = this;
    this.setData({
      currentAppointmentTimes: []
    });

    app.get('appointment/getAppointmentTime/' + beauticianId + '/' + day).then(function (data) {
      var content = data.data && data.data.content || [];
      // for (var i in [0, 0, 0, 0])
      //   content.push({})

      self.setData({
        appointmentTimeList: content
      });
    });
  },
  appointment: function appointment(event) {
    var _this = this;

    var app = getApp();
    var formId = event.detail.formId;

    // 预约
    var data = {
      shop_id: this.data.currentShop.shop_id,
      beautician_id: this.data.currentBeautician.beautician_id,
      project_id: this.data.currentProject.project_id,
      appointment_day: this.data.currentAppointmentDay.day,
      appointment_time: this.data.currentAppointmentTimes.join(','),
      from: 'xcx',
      formId: formId
    };
    app.post('cart/appointment', data).then(function () {
      _this._toast('预约成功!');
      wx.switchTab({
        url: '/pages/order/index'
      });
    }).catch(function (error) {
      _this._toast(error.detail || '预约失败!');
    });
  },
  onShow: function onShow() {
    var app = getApp();
    var self = this;

    wx.getLocation({
      success: function success(data) {
        app.get('shop/getList', { latitude: data.latitude, longitude: data.longitude }).then(function (data) {
          var result = data.data;
          var currentShop = result.content[0] || {};
          self.setData({
            shopList: result.content,
            cpShopList: result.content,
            currentShop: result.content[0] || []
          });

          if (currentShop) self.getBeauticianAndProject(currentShop.shop_id);
        });
      },
      fail: function fail() {
        wx.openSetting({
          success: function success(res) {},
          fail: function fail() {}
        });
      }
    });
  }
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4Lnd4cCJdLCJuYW1lcyI6WyJkYXRhIiwidG9hc3RUZXh0Iiwic2hvd1RvYXN0Iiwic2hvcExpc3QiLCJjcFNob3BMaXN0Iiwic2hvd1Nob3BMaXN0UG9wIiwiY3VycmVudFNob3AiLCJiZWF1dGljaWFuTGlzdCIsImN1cnJlbnRCZWF1dGljaWFuIiwicHJvamVjdExpc3QiLCJjdXJyZW50UHJvamVjdCIsImFwcG9pbnRtZW50RGF5TGlzdCIsImN1cnJlbnRBcHBvaW50bWVudERheSIsImFwcG9pbnRtZW50VGltZUxpc3QiLCJjdXJyZW50QXBwb2ludG1lbnRUaW1lcyIsImhhbmRsZXJTZWFyY2giLCJldmVudCIsInZhbHVlIiwiZGV0YWlsIiwiZmlsdGVyIiwiaXRlbSIsInNob3BfbmFtZSIsIm1hdGNoIiwiUmVnRXhwIiwic2V0RGF0YSIsInNob3dTaG9wTGlzdCIsImNob29zZVNob3AiLCJpbmRleCIsImN1cnJlbnRUYXJnZXQiLCJkYXRhc2V0IiwiZ2V0QmVhdXRpY2lhbkFuZFByb2plY3QiLCJzaG9wX2lkIiwiY2hvb3NlUHJvamVjdCIsInRpbWVMaXN0IiwiZm9yRWFjaCIsImNoZWNrZWQiLCJjaG9vc2VCZWF1dGljaWFuIiwiYmVhdXRpY2lhbklkIiwiYmVhdXRpY2lhbl9pZCIsImRheSIsImdldEFwcG9pbnRtZW50VGltZXMiLCJjaG9vc2VEYXkiLCJfdG9hc3QiLCJ0ZXh0Iiwid3giLCJ0aXRsZSIsImR1cmF0aW9uIiwiaWNvbiIsImNob29zZVRpbWUiLCJldmVyeVRpbWUiLCJ0aW1lIiwidmFsaWQiLCJwcm9qZWN0VXNlVGltZSIsInVzZV90aW1lIiwidXNlVGltZU51bSIsIk1hdGgiLCJjZWlsIiwidGltZUxpc3RMZW5ndGgiLCJsZW5ndGgiLCJzdGFydCIsInVzZVRpbWUiLCJwdXNoIiwic2hvcElkIiwiYXBwIiwiZ2V0QXBwIiwic2VsZiIsImdldCIsInRoZW4iLCJjb250ZW50IiwiZGF5cyIsIm1hcCIsInNwbGl0IiwiZGF0ZSIsIndlZWsiLCJwcm9qZWN0cyIsImJlYXV0aWNpYW5zIiwiYXBwb2ludG1lbnQiLCJmb3JtSWQiLCJwcm9qZWN0X2lkIiwiYXBwb2ludG1lbnRfZGF5IiwiYXBwb2ludG1lbnRfdGltZSIsImpvaW4iLCJmcm9tIiwicG9zdCIsInN3aXRjaFRhYiIsInVybCIsImNhdGNoIiwiZXJyb3IiLCJvblNob3ciLCJnZXRMb2NhdGlvbiIsInN1Y2Nlc3MiLCJsYXRpdHVkZSIsImxvbmdpdHVkZSIsInJlc3VsdCIsImZhaWwiLCJvcGVuU2V0dGluZyIsInJlcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBWUlBLFFBQU07QUFBQTtBQUFBO0FBQUE7O0FBQ0pDLGVBQVcsRUFEUDtBQUVKQyxlQUFXLEtBRlA7QUFHSkMsY0FBVSxFQUhOO0FBSUpDLGdCQUFZLEVBSlI7QUFLSkMscUJBQWlCLE1BTGI7QUFNSkMsaUJBQWEsRUFOVDtBQU9KQyxvQkFBZ0IsRUFQWjtBQVFKQyx1QkFBbUIsRUFSZjtBQVNKQyxpQkFBYSxFQVRUO0FBVUpDLG9CQUFnQixFQVZaO0FBV0pDLHdCQUFvQixFQVhoQjtBQVlKQywyQkFBdUIsRUFabkI7QUFhSkMseUJBQXFCLEVBYmpCO0FBY0pDLDZCQUF5QixFQWRyQixDQWN5QjtBQWR6QixHO0FBZ0JOQyxpQkFBZSx1QkFBVUMsS0FBVixFQUFpQjtBQUM5QixRQUFJQyxRQUFRRCxNQUFNRSxNQUFOLENBQWFELEtBQXpCO0FBQ0EsUUFBSWQsV0FBVyxLQUFLSCxJQUFMLENBQVVHLFFBQXpCO0FBQ0EsUUFBSUMsYUFBYUQsU0FBU2dCLE1BQVQsQ0FBZ0IsVUFBVUMsSUFBVixFQUFnQjtBQUMvQyxhQUFPQSxLQUFLQyxTQUFMLENBQWVDLEtBQWYsQ0FBcUIsSUFBSUMsTUFBSixDQUFXTixLQUFYLENBQXJCLENBQVA7QUFDRCxLQUZnQixDQUFqQjs7QUFJQSxTQUFLTyxPQUFMLENBQWE7QUFDWHBCLGtCQUFZQTtBQURELEtBQWI7QUFHRCxHO0FBQ0RxQixnQkFBYyx3QkFBWTtBQUN4QixTQUFLRCxPQUFM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LE9BQUc2QyxXQUFILENBQWU7QUFDYkMsZUFBUyxpQkFBVTFGLElBQVYsRUFBZ0I7QUFDdkIrRCxZQUFJRyxHQUFKLENBQVEsY0FBUixFQUF3QixFQUFDeUIsVUFBVTNGLEtBQUsyRixRQUFoQixFQUEwQkMsV0FBVzVGLEtBQUs0RixTQUExQyxFQUF4QixFQUE4RXpCLElBQTlFLENBQW1GLGdCQUFRO0FBQ3pGLGNBQUkwQixTQUFTN0YsS0FBS0EsSUFBbEI7QUFDQSxjQUFJTSxjQUFjdUYsT0FBT3pCLE9BQVAsQ0FBZSxDQUFmLEtBQXFCLEVBQXZDO0FBQ0FILGVBQUt6QyxPQUFMLENBQWE7QUFDWHJCLHNCQUFVMEYsT0FBT3pCLE9BRE47QUFFWGhFLHdCQUFZeUYsT0FBT3pCLE9BRlI7QUFHWDlELHlCQUFhdUYsT0FBT3pCLE9BQVAsQ0FBZSxDQUFmLEtBQXFCO0FBSHZCLFdBQWI7O0FBTUEsY0FBSTlELFdBQUosRUFDRTJELEtBQUtuQyx1QkFBTCxDQUE2QnhCLFlBQVl5QixPQUF6QztBQUNILFNBWEQ7QUFZRCxPQWRZO0FBZWIrRCxZQUFNLGdCQUFZO0FBQ2hCbEQsV0FBR21ELFdBQUgsQ0FBZTtBQUNiTCxtQkFBUyxpQkFBVU0sR0FBVixFQUFlLENBQ3ZCLENBRlk7QUFHYkYsZ0JBQU0sZ0JBQVksQ0FDakI7QUFKWSxTQUFmO0FBTUQ7QUF0QlksS0FBZjtBQXdCRCIsImZpbGUiOiJpbmRleC53eHAiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCB7XG4gICAgY29uZmlnOiB7XG4gICAgICBuYXZpZ2F0aW9uQmFyVGl0bGVUZXh0OiAn6aKE57qmJyxcbiAgICAgIHVzaW5nQ29tcG9uZW50czoge1xuICAgICAgICAnd3hjLWZsZXgnOiAnQG1pbnVpL3d4Yy1mbGV4JyxcbiAgICAgICAgJ3d4Yy1pY29uJzogJ0BtaW51aS93eGMtaWNvbicsXG4gICAgICAgICd3eGMtYXZhdGFyJzogJ0BtaW51aS93eGMtYXZhdGFyJyxcbiAgICAgICAgJ3d4Yy1tYXNrJzogJ0BtaW51aS93eGMtbWFzaycsXG4gICAgICAgICd3eGMtcG9wdXAnOiAnQG1pbnVpL3d4Yy1wb3B1cCcsXG4gICAgICAgICd3eGMtZWxpcCc6ICdAbWludWkvd3hjLWVsaXAnLFxuICAgICAgfVxuICAgIH0sXG4gICAgZGF0YToge1xuICAgICAgdG9hc3RUZXh0OiAnJyxcbiAgICAgIHNob3dUb2FzdDogZmFsc2UsXG4gICAgICBzaG9wTGlzdDogW10sXG4gICAgICBjcFNob3BMaXN0OiBbXSxcbiAgICAgIHNob3dTaG9wTGlzdFBvcDogJ2hpZGUnLFxuICAgICAgY3VycmVudFNob3A6IHt9LFxuICAgICAgYmVhdXRpY2lhbkxpc3Q6IFtdLFxuICAgICAgY3VycmVudEJlYXV0aWNpYW46IHt9LFxuICAgICAgcHJvamVjdExpc3Q6IFtdLFxuICAgICAgY3VycmVudFByb2plY3Q6IHt9LFxuICAgICAgYXBwb2ludG1lbnREYXlMaXN0OiBbXSxcbiAgICAgIGN1cnJlbnRBcHBvaW50bWVudERheTogJycsXG4gICAgICBhcHBvaW50bWVudFRpbWVMaXN0OiBbXSxcbiAgICAgIGN1cnJlbnRBcHBvaW50bWVudFRpbWVzOiBbXSwgLy8g6aKE57qm55qE5pe26Ze0XG4gICAgfSxcbiAgICBoYW5kbGVyU2VhcmNoOiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIGxldCB2YWx1ZSA9IGV2ZW50LmRldGFpbC52YWx1ZVxuICAgICAgbGV0IHNob3BMaXN0ID0gdGhpcy5kYXRhLnNob3BMaXN0XG4gICAgICBsZXQgY3BTaG9wTGlzdCA9IHNob3BMaXN0LmZpbHRlcihmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICByZXR1cm4gaXRlbS5zaG9wX25hbWUubWF0Y2gobmV3IFJlZ0V4cCh2YWx1ZSkpXG4gICAgICB9KVxuXG4gICAgICB0aGlzLnNldERhdGEoe1xuICAgICAgICBjcFNob3BMaXN0OiBjcFNob3BMaXN0XG4gICAgICB9KVxuICAgIH0sXG4gICAgc2hvd1Nob3BMaXN0OiBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLnNldERhdGEoe1xuICAgICAgICBzaG93U2hvcExpc3RQb3A6ICdzaG93J1xuICAgICAgfSlcbiAgICB9LFxuICAgIGNob29zZVNob3A6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgbGV0IGluZGV4ID0gZXZlbnQuY3VycmVudFRhcmdldC5kYXRhc2V0LmluZGV4XG4gICAgICBsZXQgY3VycmVudFNob3AgPSB0aGlzLmRhdGEuc2hvcExpc3RbaW5kZXhdXG4gICAgICB0aGlzLnNldERhdGEoe1xuICAgICAgICBjdXJyZW50U2hvcDogY3VycmVudFNob3AsXG4gICAgICAgIHNob3dTaG9wTGlzdFBvcDogJ2hpZGUnXG4gICAgICB9KVxuXG4gICAgICB0aGlzLmdldEJlYXV0aWNpYW5BbmRQcm9qZWN0KGN1cnJlbnRTaG9wLnNob3BfaWQpXG4gICAgfSxcbiAgICBjaG9vc2VQcm9qZWN0OiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIGxldCBpbmRleCA9IGV2ZW50LmN1cnJlbnRUYXJnZXQuZGF0YXNldC5pbmRleFxuICAgICAgbGV0IGN1cnJlbnRQcm9qZWN0ID0gdGhpcy5kYXRhLnByb2plY3RMaXN0W2luZGV4XVxuICAgICAgdGhpcy5zZXREYXRhKHtcbiAgICAgICAgY3VycmVudFByb2plY3Q6IGN1cnJlbnRQcm9qZWN0LFxuICAgICAgfSlcblxuICAgICAgbGV0IHRpbWVMaXN0ID0gdGhpcy5kYXRhLmFwcG9pbnRtZW50VGltZUxpc3RcbiAgICAgIHRpbWVMaXN0LmZvckVhY2goaXRlbSA9PiBpdGVtLmNoZWNrZWQgPSBmYWxzZSlcbiAgICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICAgIGN1cnJlbnRBcHBvaW50bWVudFRpbWVzOiBbXSxcbiAgICAgICAgYXBwb2ludG1lbnRUaW1lTGlzdDogdGltZUxpc3RcbiAgICAgIH0pXG4gICAgfSxcbiAgICBjaG9vc2VCZWF1dGljaWFuOiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIGxldCBpbmRleCA9IGV2ZW50LmN1cnJlbnRUYXJnZXQuZGF0YXNldC5pbmRleFxuICAgICAgbGV0IGN1cnJlbnRCZWF1dGljaWFuID0gdGhpcy5kYXRhLmJlYXV0aWNpYW5MaXN0W2luZGV4XVxuICAgICAgdGhpcy5zZXREYXRhKHtcbiAgICAgICAgY3VycmVudEJlYXV0aWNpYW46IGN1cnJlbnRCZWF1dGljaWFuLFxuICAgICAgfSlcblxuICAgICAgbGV0IGJlYXV0aWNpYW5JZCA9IGN1cnJlbnRCZWF1dGljaWFuLmJlYXV0aWNpYW5faWRcbiAgICAgIGxldCBkYXkgPSB0aGlzLmRhdGEuY3VycmVudEFwcG9pbnRtZW50RGF5LmRheVxuICAgICAgdGhpcy5nZXRBcHBvaW50bWVudFRpbWVzKGJlYXV0aWNpYW5JZCwgZGF5KVxuICAgIH0sXG4gICAgY2hvb3NlRGF5OiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIGxldCBpbmRleCA9IGV2ZW50LmN1cnJlbnRUYXJnZXQuZGF0YXNldC5pbmRleFxuICAgICAgbGV0IGN1cnJlbnRBcHBvaW50bWVudERheSA9IHRoaXMuZGF0YS5hcHBvaW50bWVudERheUxpc3RbaW5kZXhdXG4gICAgICB0aGlzLnNldERhdGEoe1xuICAgICAgICBjdXJyZW50QXBwb2ludG1lbnREYXk6IGN1cnJlbnRBcHBvaW50bWVudERheSxcbiAgICAgIH0pXG5cbiAgICAgIGxldCBiZWF1dGljaWFuSWQgPSB0aGlzLmRhdGEuY3VycmVudEJlYXV0aWNpYW4uYmVhdXRpY2lhbl9pZFxuICAgICAgbGV0IGRheSA9IGN1cnJlbnRBcHBvaW50bWVudERheS5kYXlcbiAgICAgIHRoaXMuZ2V0QXBwb2ludG1lbnRUaW1lcyhiZWF1dGljaWFuSWQsIGRheSlcbiAgICB9LFxuICAgIF90b2FzdCh0ZXh0KSB7XG4gICAgICB3eC5zaG93VG9hc3Qoe1xuICAgICAgICB0aXRsZTogdGV4dCxcbiAgICAgICAgZHVyYXRpb246IDIwMDAsXG4gICAgICAgIGljb246ICdub25lJ1xuICAgICAgfSlcbiAgICB9LFxuICAgIGNob29zZVRpbWU6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgbGV0IGV2ZXJ5VGltZSA9IDMwXG4gICAgICBsZXQgaW5kZXggPSBldmVudC5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuaW5kZXhcbiAgICAgIGxldCB0aW1lID0gdGhpcy5kYXRhLmFwcG9pbnRtZW50VGltZUxpc3RbaW5kZXhdXG4gICAgICBpZiAoIXRpbWUudmFsaWQpXG4gICAgICAgIHJldHVybiBmYWxzZVxuXG4gICAgICBsZXQgdGltZUxpc3QgPSB0aGlzLmRhdGEuYXBwb2ludG1lbnRUaW1lTGlzdFxuICAgICAgdGltZUxpc3QuZm9yRWFjaChpdGVtID0+IGl0ZW0uY2hlY2tlZCA9IGZhbHNlKVxuXG4gICAgICBsZXQgcHJvamVjdFVzZVRpbWUgPSB0aGlzLmRhdGEuY3VycmVudFByb2plY3QudXNlX3RpbWVcbiAgICAgIGxldCB1c2VUaW1lTnVtID0gTWF0aC5jZWlsKHByb2plY3RVc2VUaW1lIC8gZXZlcnlUaW1lKVxuICAgICAgbGV0IHRpbWVMaXN0TGVuZ3RoID0gdGhpcy5kYXRhLmFwcG9pbnRtZW50VGltZUxpc3QubGVuZ3RoXG4gICAgICBpZiAoaW5kZXggKyB1c2VUaW1lTnVtID4gdGltZUxpc3RMZW5ndGgpIHtcbiAgICAgICAgdGhpcy5zZXREYXRhKHtcbiAgICAgICAgICBjdXJyZW50QXBwb2ludG1lbnRUaW1lczogW10sXG4gICAgICAgICAgYXBwb2ludG1lbnRUaW1lTGlzdDogdGltZUxpc3QsXG4gICAgICAgIH0pXG5cbiAgICAgICAgdGhpcy5fdG9hc3QoJ+mihOe6puaXtumXtOS4jei2sycpXG5cbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgICBsZXQgc3RhcnQgPSAwXG4gICAgICBsZXQgdXNlVGltZSA9IFtdXG4gICAgICB3aGlsZSAoc3RhcnQgPCB1c2VUaW1lTnVtKSB7XG4gICAgICAgIGxldCBpdGVtID0gdGltZUxpc3RbaW5kZXggKyBzdGFydCsrXVxuICAgICAgICBpZighaXRlbS52YWxpZCkge1xuICAgICAgICAgIHRpbWVMaXN0LmZvckVhY2goaXRlbSA9PiBpdGVtLmNoZWNrZWQgPSBmYWxzZSlcbiAgICAgICAgICB1c2VUaW1lID0gW11cbiAgICAgICAgICB0aGlzLnNldERhdGEoe1xuICAgICAgICAgICAgY3VycmVudEFwcG9pbnRtZW50VGltZXM6IHVzZVRpbWUsXG4gICAgICAgICAgICBhcHBvaW50bWVudFRpbWVMaXN0OiB0aW1lTGlzdCxcbiAgICAgICAgICB9KVxuICAgICAgICAgIHRoaXMuX3RvYXN0KCfpooTnuqbml7bpl7TkuI3otrMnKVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGl0ZW0uY2hlY2tlZCA9IHRydWVcbiAgICAgICAgdXNlVGltZS5wdXNoKGl0ZW0udGltZSlcbiAgICAgIH1cblxuICAgICAgdGhpcy5zZXREYXRhKHtcbiAgICAgICAgY3VycmVudEFwcG9pbnRtZW50VGltZXM6IHVzZVRpbWUsXG4gICAgICAgIGFwcG9pbnRtZW50VGltZUxpc3Q6IHRpbWVMaXN0XG4gICAgICB9KVxuXG4gICAgfSxcbiAgICBnZXRCZWF1dGljaWFuQW5kUHJvamVjdDogZnVuY3Rpb24gKHNob3BJZCkge1xuICAgICAgbGV0IGFwcCA9IGdldEFwcCgpXG4gICAgICBsZXQgc2VsZiA9IHRoaXNcbiAgICAgIGFwcC5nZXQoYGFwcG9pbnRtZW50L2dldEJlYXV0aWNpYW5BbmRQcm9qZWN0LyR7c2hvcElkfWApLnRoZW4oZGF0YSA9PiB7XG4gICAgICAgIGxldCBjb250ZW50ID0gKGRhdGEuZGF0YSAmJiBkYXRhLmRhdGEuY29udGVudCkgfHwge31cblxuICAgICAgICBjb250ZW50LmRheXMgPSBjb250ZW50LmRheXMubWFwKGl0ZW0gPT4ge1xuICAgICAgICAgIGxldCBkYXkgPSBpdGVtLnNwbGl0KCcjJylcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZGF0ZTogZGF5WzBdLFxuICAgICAgICAgICAgd2VlazogZGF5WzFdLFxuICAgICAgICAgICAgZGF5OiBkYXlbMl1cbiAgICAgICAgICB9XG4gICAgICAgIH0pXG5cbiAgICAgICAgbGV0IGN1cnJlbnRQcm9qZWN0ID0gY29udGVudC5wcm9qZWN0c1swXSB8fCB7fVxuICAgICAgICBsZXQgY3VycmVudEJlYXV0aWNpYW4gPSBjb250ZW50LmJlYXV0aWNpYW5zWzBdIHx8IHt9XG4gICAgICAgIGxldCBjdXJyZW50QXBwb2ludG1lbnREYXkgPSBjb250ZW50LmRheXNbMF0gfHwge31cblxuICAgICAgICBzZWxmLnNldERhdGEoe1xuICAgICAgICAgIGJlYXV0aWNpYW5MaXN0OiBjb250ZW50LmJlYXV0aWNpYW5zLFxuICAgICAgICAgIHByb2plY3RMaXN0OiBjb250ZW50LnByb2plY3RzLFxuICAgICAgICAgIGFwcG9pbnRtZW50RGF5TGlzdDogY29udGVudC5kYXlzLFxuICAgICAgICAgIGN1cnJlbnRQcm9qZWN0LFxuICAgICAgICAgIGN1cnJlbnRCZWF1dGljaWFuLFxuICAgICAgICAgIGN1cnJlbnRBcHBvaW50bWVudERheSxcbiAgICAgICAgfSlcblxuICAgICAgICBzZWxmLmdldEFwcG9pbnRtZW50VGltZXMoY3VycmVudEJlYXV0aWNpYW4uYmVhdXRpY2lhbl9pZCwgY3VycmVudEFwcG9pbnRtZW50RGF5LmRheSlcbiAgICAgIH0pXG5cbiAgICB9LFxuICAgIGdldEFwcG9pbnRtZW50VGltZXM6IGZ1bmN0aW9uIChiZWF1dGljaWFuSWQsIGRheSkge1xuICAgICAgbGV0IGFwcCA9IGdldEFwcCgpXG4gICAgICBsZXQgc2VsZiA9IHRoaXNcbiAgICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICAgIGN1cnJlbnRBcHBvaW50bWVudFRpbWVzOiBbXVxuICAgICAgfSlcblxuICAgICAgYXBwLmdldCgnYXBwb2ludG1lbnQvZ2V0QXBwb2ludG1lbnRUaW1lLycgKyBiZWF1dGljaWFuSWQgKyAnLycgKyBkYXkpXG4gICAgICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgICAgbGV0IGNvbnRlbnQgPSAoZGF0YS5kYXRhICYmIGRhdGEuZGF0YS5jb250ZW50KSB8fCBbXVxuICAgICAgICAgIC8vIGZvciAodmFyIGkgaW4gWzAsIDAsIDAsIDBdKVxuICAgICAgICAgIC8vICAgY29udGVudC5wdXNoKHt9KVxuXG4gICAgICAgICAgc2VsZi5zZXREYXRhKHtcbiAgICAgICAgICAgIGFwcG9pbnRtZW50VGltZUxpc3Q6IGNvbnRlbnRcbiAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH0sXG4gICAgYXBwb2ludG1lbnQ6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgbGV0IGFwcCA9IGdldEFwcCgpXG4gICAgICBsZXQgZm9ybUlkID0gZXZlbnQuZGV0YWlsLmZvcm1JZFxuXG4gICAgICAvLyDpooTnuqZcbiAgICAgIGxldCBkYXRhID0ge1xuICAgICAgICBzaG9wX2lkOiB0aGlzLmRhdGEuY3VycmVudFNob3Auc2hvcF9pZCxcbiAgICAgICAgYmVhdXRpY2lhbl9pZDogdGhpcy5kYXRhLmN1cnJlbnRCZWF1dGljaWFuLmJlYXV0aWNpYW5faWQsXG4gICAgICAgIHByb2plY3RfaWQ6IHRoaXMuZGF0YS5jdXJyZW50UHJvamVjdC5wcm9qZWN0X2lkLFxuICAgICAgICBhcHBvaW50bWVudF9kYXk6IHRoaXMuZGF0YS5jdXJyZW50QXBwb2ludG1lbnREYXkuZGF5LFxuICAgICAgICBhcHBvaW50bWVudF90aW1lOiB0aGlzLmRhdGEuY3VycmVudEFwcG9pbnRtZW50VGltZXMuam9pbignLCcpLFxuICAgICAgICBmcm9tOiAneGN4JyxcbiAgICAgICAgZm9ybUlkOiBmb3JtSWQsXG4gICAgICB9XG4gICAgICBhcHAucG9zdCgnY2FydC9hcHBvaW50bWVudCcsIGRhdGEpXG4gICAgICAgIC50aGVuKCgpID0+ICAge1xuICAgICAgICAgIHRoaXMuX3RvYXN0KCfpooTnuqbmiJDlip8hJylcbiAgICAgICAgICB3eC5zd2l0Y2hUYWIoe1xuICAgICAgICAgICAgdXJsOiAnL3BhZ2VzL29yZGVyL2luZGV4J1xuICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgICAgdGhpcy5fdG9hc3QoZXJyb3IuZGV0YWlsIHx8ICfpooTnuqblpLHotKUhJylcbiAgICAgICAgfSlcbiAgICB9LFxuICAgIG9uU2hvdzogZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IGFwcCA9IGdldEFwcCgpXG4gICAgICBsZXQgc2VsZiA9IHRoaXNcblxuICAgICAgd3guZ2V0TG9jYXRpb24oe1xuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgIGFwcC5nZXQoJ3Nob3AvZ2V0TGlzdCcsIHtsYXRpdHVkZTogZGF0YS5sYXRpdHVkZSwgbG9uZ2l0dWRlOiBkYXRhLmxvbmdpdHVkZX0pLnRoZW4oZGF0YSA9PiB7XG4gICAgICAgICAgICBsZXQgcmVzdWx0ID0gZGF0YS5kYXRhXG4gICAgICAgICAgICBsZXQgY3VycmVudFNob3AgPSByZXN1bHQuY29udGVudFswXSB8fCB7fVxuICAgICAgICAgICAgc2VsZi5zZXREYXRhKHtcbiAgICAgICAgICAgICAgc2hvcExpc3Q6IHJlc3VsdC5jb250ZW50LFxuICAgICAgICAgICAgICBjcFNob3BMaXN0OiByZXN1bHQuY29udGVudCxcbiAgICAgICAgICAgICAgY3VycmVudFNob3A6IHJlc3VsdC5jb250ZW50WzBdIHx8IFtdXG4gICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICBpZiAoY3VycmVudFNob3ApXG4gICAgICAgICAgICAgIHNlbGYuZ2V0QmVhdXRpY2lhbkFuZFByb2plY3QoY3VycmVudFNob3Auc2hvcF9pZClcbiAgICAgICAgICB9KVxuICAgICAgICB9LFxuICAgICAgICBmYWlsOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgd3gub3BlblNldHRpbmcoe1xuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGZhaWw6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICB9KVxuICAgIH1cbiAgfSJdfQ==